import{_ as n,a as t,b as e,c as r,i as c,s as i,d as o,S as s,y as a,Z as u,z as f,A as l,$ as d,j as $,B as v,g as m,D as h,a0 as p,J as g,K as y,L as I,t as w,h as D,M as E,R as b,F as R,G as S,H as _,I as k,T as x,P as T,Q as A,bi as V,ab as C,a4 as N,a7 as H,as as M,bj as O,bk as j,a6 as L,ap as B,aq as P,a9 as G,a2 as q,av as z,aj as F,bl as U,bm as W,bn as K,aP as X,aR as J,l as Q,ak as Z,bo as Y,bp as nn,bq as tn,br as en,bs as rn,o as cn,bt as on,r as sn,u as an,v as un,w as fn,aS as ln,bu as dn,e as $n,O as vn,bv as mn,m as hn,a1 as pn,bw as gn,bx as yn,bg as In,by as wn,bz as Dn,aT as En,aU as bn,f as Rn}from"./client.e229b9da.js";import{S as Sn}from"./Proxy.828d0d07.js";import"./Hotspot.5c809319.js";import"./ContentPanel.9936b39d.js";import{C as _n}from"./ContentLoader.a887c96e.js";import{L as kn}from"./post_like_selected.c79724df.js";import{S as xn}from"./send.53c7ac4a.js";import{L as Tn}from"./Location.8fdeefb0.js";function An(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(n){return!1}}();return function(){var c,i=t(n);if(r){var o=t(this).constructor;c=Reflect.construct(i,arguments,o)}else c=i.apply(this,arguments);return e(this,c)}}function Vn(n){var t,e;return{c:function(){t=a("div"),e=u(n[3]),this.h()},l:function(r){t=f(r,"DIV",{class:!0});var c=l(t);e=d(c,n[3]),c.forEach($),this.h()},h:function(){v(t,"class","dateHeader svelte-37ndgl")},m:function(n,r){m(n,t,r),h(t,e)},p:function(n,t){8&t&&p(e,n[3])},d:function(n){n&&$(t)}}}function Cn(n){var t,e=new G({props:{user:n[4],onClick:n[10]?n[11]:null,useThumb:!0}});return{c:function(){g(e.$$.fragment)},l:function(n){y(e.$$.fragment,n)},m:function(n,r){I(e,n,r),t=!0},p:function(n,t){var r={};16&t&&(r.user=n[4]),1024&t&&(r.onClick=n[10]?n[11]:null),e.$set(r)},i:function(n){t||(w(e.$$.fragment,n),t=!0)},o:function(n){D(e.$$.fragment,n),t=!1},d:function(n){E(e,n)}}}function Nn(n){var t,e=new q({props:{className:"likeButton",icon:kn}});return{c:function(){g(e.$$.fragment)},l:function(n){y(e.$$.fragment,n)},m:function(n,r){I(e,n,r),t=!0},p:b,i:function(n){t||(w(e.$$.fragment,n),t=!0)},o:function(n){D(e.$$.fragment,n),t=!1},d:function(n){E(e,n)}}}function Hn(n){var t,e,r,c,i,o,s,u,d,p=n[8]&&Vn(n),g=!n[5]&&!n[7]&&Cn(n),y=n[9]&&Nn();return{c:function(){t=a("div"),p&&p.c(),e=R(),r=a("div"),g&&g.c(),c=R(),i=a("div"),o=a("div"),s=a("div"),u=R(),y&&y.c(),this.h()},l:function(n){t=f(n,"DIV",{class:!0});var a=l(t);p&&p.l(a),e=S(a),r=f(a,"DIV",{class:!0});var d=l(r);g&&g.l(d),c=S(d),i=f(d,"DIV",{class:!0});var v=l(i);o=f(v,"DIV",{class:!0});var m=l(o);s=f(m,"DIV",{class:!0}),l(s).forEach($),m.forEach($),u=S(v),y&&y.l(v),v.forEach($),d.forEach($),a.forEach($),this.h()},h:function(){v(s,"class","message svelte-37ndgl"),v(o,"class","detailInnerContent svelte-37ndgl"),v(i,"class","detailContent svelte-37ndgl"),v(r,"class","messageContent svelte-37ndgl"),_(r,"userBreak",n[6]),_(r,"isSelf",n[5]),v(t,"class","messageListItem svelte-37ndgl")},m:function(a,f){m(a,t,f),p&&p.m(t,null),h(t,e),h(t,r),g&&g.m(r,null),h(r,c),h(r,i),h(i,o),h(o,s),s.innerHTML=n[2],h(i,u),y&&y.m(i,null),d=!0},p:function(n,o){var a=k(o,1)[0];n[8]?p?p.p(n,a):((p=Vn(n)).c(),p.m(t,e)):p&&(p.d(1),p=null),n[5]||n[7]?g&&(x(),D(g,1,1,function(){g=null}),T()):g?(g.p(n,a),160&a&&w(g,1)):((g=Cn(n)).c(),w(g,1),g.m(r,c)),(!d||4&a)&&(s.innerHTML=n[2]),n[9]?y?(y.p(n,a),512&a&&w(y,1)):((y=Nn()).c(),w(y,1),y.m(i,null)):y&&(x(),D(y,1,1,function(){y=null}),T()),64&a&&_(r,"userBreak",n[6]),32&a&&_(r,"isSelf",n[5])},i:function(n){d||(w(g),w(y),d=!0)},o:function(n){D(g),D(y),d=!1},d:function(n){n&&$(t),p&&p.d(),g&&g.d(),y&&y.d()}}}function Mn(n,t,e){var r,c,i,o,s,a=b,u=function(){return a(),a=N(R,function(n){return e(12,r=n)}),R},f=b,l=b;A(n,V,function(n){return e(16,c=n)}),A(n,C,function(n){return e(19,o=n)}),n.$$.on_destroy.push(function(){return a()}),n.$$.on_destroy.push(function(){return f()}),n.$$.on_destroy.push(function(){return l()});var d,$,v,m,h,p,g,y,I,w,D,E,R=t.message;return u(),n.$set=function(n){"message"in n&&u(e(0,R=n.message))},n.$$.update=function(){4096&n.$$.dirty&&(e(1,d=r&&r.lastMessage||H(null)),l(),l=N(d,function(n){return e(20,s=n)})),4096&n.$$.dirty&&e(2,$=r&&r.message&&M(r.message)||""),4096&n.$$.dirty&&(r&&r.id||null),4096&n.$$.dirty&&e(14,v=r&&r.createdAt||null),16384&n.$$.dirty&&e(3,m=v&&O(v)||""),69632&n.$$.dirty&&e(15,h=r&&c&&j(c,r.userId)||null),49152&n.$$.dirty&&(e(4,p=h&&v&&L(h,v)||H(null)),f(),f=N(p,function(n){return e(18,i=n)})),294912&n.$$.dirty&&e(17,i&&i.name||h&&h.name||""),557056&n.$$.dirty&&e(5,g=!h||h.id===o),1052672&n.$$.dirty&&e(6,y=s&&r.userId!==s.userId||!1),1052672&n.$$.dirty&&e(7,I=s&&r.userId==s.userId||!1),1052672&n.$$.dirty&&e(8,w=r&&(!s||B(s.createdAt,r.createdAt)>P.DATE_SHOWN_MESSAGE_DATE_DIFF)||!1),4096&n.$$.dirty&&e(9,D=r&&r.likes&&r.likes.length||!1),n.$$.dirty,262144&n.$$.dirty&&e(10,E=i&&i.name||!1)},[R,d,$,m,p,g,y,I,w,D,E,function(){E&&z(i.id)}]}var On=function(t){n(a,s);var e=An(a);function a(n){var t;return r(this,a),t=e.call(this),c(o(t),n,Mn,Hn,i,{message:0}),t}return a}();function jn(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(n){return!1}}();return function(){var c,i=t(n);if(r){var o=t(this).constructor;c=Reflect.construct(i,arguments,o)}else c=i.apply(this,arguments);return e(this,c)}}function Ln(n,t,e){var r=n.slice();return r[3]=t[e],r}function Bn(n){var t,e=new On({props:{message:n[3]}});return{c:function(){g(e.$$.fragment)},l:function(n){y(e.$$.fragment,n)},m:function(n,r){I(e,n,r),t=!0},p:function(n,t){var r={};4&t&&(r.message=n[3]),e.$set(r)},i:function(n){t||(w(e.$$.fragment,n),t=!0)},o:function(n){D(e.$$.fragment,n),t=!1},d:function(n){E(e,n)}}}function Pn(n){for(var t,e,r,c=n[2],i=[],o=0;o<c.length;o+=1)i[o]=Bn(Ln(n,c,o));var s=function(n){return D(i[n],1,1,function(){i[n]=null})};return{c:function(){t=a("div");for(var n=0;n<i.length;n+=1)i[n].c();this.h()},l:function(n){t=f(n,"DIV",{class:!0});for(var e=l(t),r=0;r<i.length;r+=1)i[r].l(e);e.forEach($),this.h()},h:function(){v(t,"class",e="messageList "+n[1]+" svelte-szvkl4")},m:function(n,e){m(n,t,e);for(var c=0;c<i.length;c+=1)i[c].m(t,null);r=!0},p:function(n,o){var a=k(o,1)[0];if(4&a){var u;for(c=n[2],u=0;u<c.length;u+=1){var f=Ln(n,c,u);i[u]?(i[u].p(f,a),w(i[u],1)):(i[u]=Bn(f),i[u].c(),w(i[u],1),i[u].m(t,null))}for(x(),u=c.length;u<i.length;u+=1)s(u);T()}(!r||2&a&&e!==(e="messageList "+n[1]+" svelte-szvkl4"))&&v(t,"class",e)},i:function(n){if(!r){for(var t=0;t<c.length;t+=1)w(i[t]);r=!0}},o:function(n){i=i.filter(Boolean);for(var t=0;t<i.length;t+=1)D(i[t]);r=!1},d:function(n){n&&$(t),F(i,n)}}}function Gn(n,t,e){var r,c=b,i=function(){return c(),c=N(o,function(n){return e(2,r=n)}),o};n.$$.on_destroy.push(function(){return c()});var o=t.messages;i();var s=t.className,a=void 0===s?"":s;return n.$set=function(n){"messages"in n&&i(e(0,o=n.messages)),"className"in n&&e(1,a=n.className)},[o,a,r]}var qn=function(t){n(a,s);var e=jn(a);function a(n){var t;return r(this,a),t=e.call(this),c(o(t),n,Gn,Pn,i,{messages:0,className:1}),t}return a}();function zn(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(n){return!1}}();return function(){var c,i=t(n);if(r){var o=t(this).constructor;c=Reflect.construct(i,arguments,o)}else c=i.apply(this,arguments);return e(this,c)}}function Fn(n){var t,e,r,c,i,o,s,u,d=new q({props:{className:"sendButton",disabled:!n[2],onClick:n[3],icon:xn}});return{c:function(){t=a("div"),e=a("div"),g(d.$$.fragment),r=R(),c=a("div"),i=a("textarea"),this.h()},l:function(n){t=f(n,"DIV",{class:!0});var o=l(t);e=f(o,"DIV",{class:!0});var s=l(e);y(d.$$.fragment,s),r=S(s),c=f(s,"DIV",{class:!0});var a=l(c);i=f(a,"TEXTAREA",{rows:!0,class:!0}),l(i).forEach($),a.forEach($),s.forEach($),o.forEach($),this.h()},h:function(){v(i,"rows","1"),v(i,"class","svelte-uhjl0u"),v(c,"class","field svelte-uhjl0u"),v(e,"class","fieldRegion svelte-uhjl0u"),v(t,"class","messageInput svelte-uhjl0u")},m:function(a,f){m(a,t,f),h(t,e),I(d,e,null),h(e,r),h(e,c),h(c,i),J(i,n[0]),n[13](i),o=!0,s||(u=[Q(i,"input",n[12]),Q(i,"keypress",n[14])],s=!0)},p:function(n,t){var e=k(t,1)[0],r={};4&e&&(r.disabled=!n[2]),d.$set(r),1&e&&J(i,n[0])},i:function(n){o||(w(d.$$.fragment,n),o=!0)},o:function(n){D(d.$$.fragment,n),o=!1},d:function(e){e&&$(t),E(d),n[13](null),s=!1,Z(u)}}}function Un(n,t,e){var r,c,i;A(n,Y,function(n){return e(6,r=n)}),A(n,nn,function(n){return e(7,c=n)}),A(n,tn,function(n){return e(8,i=n)});var o,s=t.message,a=void 0===s?"":s,u=t.image,f=void 0===u?null:u,l=en(),d=rn();function $(){if(h){var n={id:l,message:on(a)};r&&!c&&(n.conversationId=r),f&&(n.image=f),c&&(n.newConversation=!0,n.targetUserIds=i,n.conversationId=d),e(0,a=""),l=en(),function(n){if(U()){var t=W(n);return t&&t.then(function(n){n&&!n.error&&n.newConversation&&(n.conversation&&K(n.conversation),n.conversationId&&X(n.conversationId,!0,!0))}),t}}(n).then(function(n){n&&(n.success||n.addedMessage||n.duplicateKey)})}}function v(){h&&($(),o&&o.focus())}function m(){sn(an.mark(function n(){var t;return an.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,un();case 2:o&&o.style&&"undefined"!=typeof window&&window.getComputedStyle&&(e(1,o.style.height="inherit",o),window.getComputedStyle(o)&&(t=o.scrollHeight+4,e(1,o.style.height=t+"px",o)));case 3:case"end":return n.stop()}},n)}))()}cn(function(){o&&o.focus()});var h;return n.$set=function(n){"message"in n&&e(0,a=n.message),"image"in n&&e(4,f=n.image)},n.$$.update=function(){209&n.$$.dirty&&e(2,h=(r||c)&&!(!on(a)&&!f)),1&n.$$.dirty&&m()},[a,o,h,v,f,l,r,c,i,d,$,m,function(){a=this.value,e(0,a)},function(n){fn[n?"unshift":"push"](function(){e(1,o=n)})},function(n){return ln(n,{action:v,actionOnCtrl:!0,preventBlur:!0})}]}var Wn=function(t){n(a,s);var e=zn(a);function a(n){var t;return r(this,a),t=e.call(this),c(o(t),n,Un,Fn,i,{message:0,image:4}),t}return a}();function Kn(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(n){return!1}}();return function(){var c,i=t(n);if(r){var o=t(this).constructor;c=Reflect.construct(i,arguments,o)}else c=i.apply(this,arguments);return e(this,c)}}function Xn(n){var t,e=new Tn({props:{location:n[2]}});return{c:function(){g(e.$$.fragment)},l:function(n){y(e.$$.fragment,n)},m:function(n,r){I(e,n,r),t=!0},p:function(n,t){var r={};4&t&&(r.location=n[2]),e.$set(r)},i:function(n){t||(w(e.$$.fragment,n),t=!0)},o:function(n){D(e.$$.fragment,n),t=!1},d:function(n){E(e,n)}}}function Jn(n){var t,e,r,c,i,o,s,b,_,A,V,C,N,H=new G({props:{user:dn,useThumb:!0}}),M=n[2]&&Xn(n);return{c:function(){t=a("div"),e=a("div"),r=a("div"),g(H.$$.fragment),c=R(),i=a("div"),o=u(n[0]),s=R(),b=a("div"),_=u(n[1]),A=R(),M&&M.c(),this.h()},l:function(a){t=f(a,"DIV",{class:!0});var u=l(t);e=f(u,"DIV",{class:!0});var v=l(e);r=f(v,"DIV",{class:!0});var m=l(r);y(H.$$.fragment,m),c=S(m),i=f(m,"DIV",{class:!0});var h=l(i);o=d(h,n[0]),h.forEach($),s=S(m),b=f(m,"DIV",{class:!0});var p=l(b);_=d(p,n[1]),p.forEach($),m.forEach($),A=S(v),M&&M.l(v),v.forEach($),u.forEach($),this.h()},h:function(){v(i,"class","userDisplayName svelte-yn8q53"),v(b,"class","username svelte-yn8q53"),v(r,"class","profileRegion button svelte-yn8q53"),v(e,"class","profileInfo svelte-yn8q53"),v(t,"class","conversationProfile svelte-yn8q53")},m:function(a,u){m(a,t,u),h(t,e),h(e,r),I(H,r,null),h(r,c),h(r,i),h(i,o),h(r,s),h(r,b),h(b,_),h(e,A),M&&M.m(e,null),V=!0,C||(N=Q(r,"click",n[3]),C=!0)},p:function(n,t){var r=k(t,1)[0];(!V||1&r)&&p(o,n[0]),(!V||2&r)&&p(_,n[1]),n[2]?M?(M.p(n,r),4&r&&w(M,1)):((M=Xn(n)).c(),w(M,1),M.m(e,null)):M&&(x(),D(M,1,1,function(){M=null}),T())},i:function(n){V||(w(H.$$.fragment,n),w(M),V=!0)},o:function(n){D(H.$$.fragment,n),D(M),V=!1},d:function(n){n&&$(t),E(H),M&&M.d(),C=!1,N()}}}function Qn(n,t,e){var r,c,i,o;return A(n,dn,function(n){return e(4,r=n)}),n.$$.update=function(){16&n.$$.dirty&&e(0,c=r&&r.name||""),16&n.$$.dirty&&e(1,i=r&&r.username&&"@"+r.username||""),16&n.$$.dirty&&e(2,o=r&&r.location||"")},[c,i,o,function(){r&&r.id&&z(r.id)}]}var Zn=function(t){n(a,s);var e=Kn(a);function a(n){var t;return r(this,a),t=e.call(this),c(o(t),n,Qn,Jn,i,{}),t}return a}();function Yn(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(n){return!1}}();return function(){var c,i=t(n);if(r){var o=t(this).constructor;c=Reflect.construct(i,arguments,o)}else c=i.apply(this,arguments);return e(this,c)}}function nt(n){var t,e;function r(t){n[27].call(null,t)}var c={onScroll:n[10],anchorToBottom:!0,id:"conversation",$$slots:{default:[it]},$$scope:{ctx:n}};void 0!==n[2]&&(c.scrollRegion=n[2]);var i=new Sn({props:c});return fn.push(function(){return En(i,"scrollRegion",r)}),{c:function(){g(i.$$.fragment)},l:function(n){y(i.$$.fragment,n)},m:function(n,t){I(i,n,t),e=!0},p:function(n,e){var r={};268435617&e&&(r.$$scope={dirty:e,ctx:n}),!t&&4&e&&(t=!0,r.scrollRegion=n[2],bn(function(){return t=!1})),i.$set(r)},i:function(n){e||(w(i.$$.fragment,n),e=!0)},o:function(n){D(i.$$.fragment,n),e=!1},d:function(n){E(i,n)}}}function tt(n){var t,e=new _n({props:{label:pn.CONVERSATION.NO_MESSAGES}});return{c:function(){g(e.$$.fragment)},l:function(n){y(e.$$.fragment,n)},m:function(n,r){I(e,n,r),t=!0},p:b,i:function(n){t||(w(e.$$.fragment,n),t=!0)},o:function(n){D(e.$$.fragment,n),t=!1},d:function(n){E(e,n)}}}function et(n){var t,e=new _n({props:{label:pn.LOADING.MESSAGES}});return{c:function(){g(e.$$.fragment)},l:function(n){y(e.$$.fragment,n)},m:function(n,r){I(e,n,r),t=!0},p:b,i:function(n){t||(w(e.$$.fragment,n),t=!0)},o:function(n){D(e.$$.fragment,n),t=!1},d:function(n){E(e,n)}}}function rt(n){var t,e=new qn({props:{messages:n[0]}});return{c:function(){g(e.$$.fragment)},l:function(n){y(e.$$.fragment,n)},m:function(n,r){I(e,n,r),t=!0},p:function(n,t){var r={};1&t&&(r.messages=n[0]),e.$set(r)},i:function(n){t||(w(e.$$.fragment,n),t=!0)},o:function(n){D(e.$$.fragment,n),t=!1},d:function(n){E(e,n)}}}function ct(n){var t,e=new Zn({});return{c:function(){g(e.$$.fragment)},l:function(n){y(e.$$.fragment,n)},m:function(n,r){I(e,n,r),t=!0},p:b,i:function(n){t||(w(e.$$.fragment,n),t=!0)},o:function(n){D(e.$$.fragment,n),t=!1},d:function(n){E(e,n)}}}function it(n){var t,e,r,c,i=[ct,rt],o=[];function s(n,t){return n[7]?0:n[5]?1:-1}return~(t=s(n))&&(e=o[t]=i[t](n)),{c:function(){e&&e.c(),r=Rn()},l:function(n){e&&e.l(n),r=Rn()},m:function(n,e){~t&&o[t].m(n,e),m(n,r,e),c=!0},p:function(n,c){var a=t;(t=s(n))===a?~t&&o[t].p(n,c):(e&&(x(),D(o[a],1,1,function(){o[a]=null}),T()),~t?((e=o[t])||(e=o[t]=i[t](n)).c(),w(e,1),e.m(r.parentNode,r)):e=null)},i:function(n){c||(w(e),c=!0)},o:function(n){D(e),c=!1},d:function(n){~t&&o[t].d(n),n&&$(r)}}}function ot(n){var t,e,r,c,i,o=pn.CONVERSATION.MESSAGES_ADDED+"";return{c:function(){t=a("div"),e=a("div"),r=u(o),this.h()},l:function(n){t=f(n,"DIV",{class:!0});var c=l(t);e=f(c,"DIV",{class:!0});var i=l(e);r=d(i,o),i.forEach($),c.forEach($),this.h()},h:function(){v(e,"class","messagesAddedIndicator button svelte-ed6b4u"),v(t,"class","messagesAddedIndicatorContainer svelte-ed6b4u")},m:function(o,s){m(o,t,s),h(t,e),h(e,r),c||(i=Q(e,"click",n[9]),c=!0)},p:b,d:function(n){n&&$(t),c=!1,i()}}}function st(n){var t,e=new Wn({});return{c:function(){g(e.$$.fragment)},l:function(n){y(e.$$.fragment,n)},m:function(n,r){I(e,n,r),t=!0},i:function(n){t||(w(e.$$.fragment,n),t=!0)},o:function(n){D(e.$$.fragment,n),t=!1},d:function(n){E(e,n)}}}function at(n){var t,e,r,c,i,o,s,u,d,p;$n(n[26]);var g=[et,tt,nt],y=[];function I(n,t){return n[6]?0:n[5]&&n[5].length||n[7]?2:1}c=I(n),i=y[c]=g[c](n);var E=n[1]&&ot(n),b=n[8]&&st();return{c:function(){t=R(),e=a("div"),r=a("div"),i.c(),o=R(),E&&E.c(),s=R(),b&&b.c(),this.h()},l:function(n){vn('[data-svelte="svelte-1y4v7mn"]',document.head).forEach($),t=S(n),e=f(n,"DIV",{class:!0});var c=l(e);r=f(c,"DIV",{class:!0});var a=l(r);i.l(a),o=S(a),E&&E.l(a),a.forEach($),s=S(c),b&&b.l(c),c.forEach($),this.h()},h:function(){document.title="Flock",v(r,"class","messagesView svelte-ed6b4u"),_(r,"newConversation",n[7]),v(e,"class","content svelte-ed6b4u")},m:function(i,a){m(i,t,a),m(i,e,a),h(e,r),y[c].m(r,null),h(r,o),E&&E.m(r,null),h(e,s),b&&b.m(e,null),u=!0,d||(p=Q(window,"resize",n[26]),d=!0)},p:function(n,t){var s=k(t,1)[0],a=c;(c=I(n))===a?y[c].p(n,s):(x(),D(y[a],1,1,function(){y[a]=null}),T(),(i=y[c])||(i=y[c]=g[c](n)).c(),w(i,1),i.m(r,o)),n[1]?E?E.p(n,s):((E=ot(n)).c(),E.m(r,null)):E&&(E.d(1),E=null),128&s&&_(r,"newConversation",n[7]),n[8]?b?256&s&&w(b,1):((b=st()).c(),w(b,1),b.m(e,null)):b&&(x(),D(b,1,1,function(){b=null}),T())},i:function(n){u||(w(i),w(b),u=!0)},o:function(n){D(i),D(b),u=!1},d:function(n){n&&$(t),n&&$(e),y[c].d(),E&&E.d(),b&&b.d(),d=!1,p()}}}function ut(n,t,e){var r,c,i,o,s,a,u,f,l=b,d=function(){return l(),l=N(m,function(n){return e(5,s=n)}),m};A(n,V,function(n){return e(14,r=n)}),A(n,C,function(n){return e(15,c=n)}),A(n,gn,function(n){return e(16,i=n)}),A(n,Y,function(n){return e(17,o=n)}),A(n,yn,function(n){return e(19,a=n)}),A(n,In,function(n){return e(21,u=n)}),A(n,nn,function(n){return e(7,f=n)}),n.$$.on_destroy.push(function(){return l()}),mn();var $=0,v=t.messages,m=void 0===v?H(null):v;function h(){d(e(0,m=r&&wn({conversationId:o},null,r.isNew)||m))}d();var p,g,y,I=!1,w=0;function D(){return E.apply(this,arguments)}function E(){return(E=sn(an.mark(function n(){return an.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!p){n.next=4;break}return n.next=3,un();case 3:p&&p.scrollTo(0,p.scrollHeight);case 4:case"end":return n.stop()}},n)}))).apply(this,arguments)}function R(){return S.apply(this,arguments)}function S(){return(S=sn(an.mark(function n(){return an.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!p){n.next=9;break}if(!(s&&s.length>$)){n.next=9;break}if(!(p.scrollTop+p.offsetHeight>p.scrollHeight-P.MIN_AUTO_SCROLL_BOTTOM_DIST)){n.next=8;break}return n.next=5,un();case 5:p.scrollTo(0,p.scrollHeight),n.next=9;break;case 8:e(1,I=!0);case 9:$=s?s.length:0;case 10:case"end":return n.stop()}},n)}))).apply(this,arguments)}var _,k,x,T,M,O,j=!1;return cn(function(){j=!0,Dn.on("messagedAdded",D)}),hn(function(){j=!1,Dn.off("messagedAdded",D)}),n.$set=function(n){"messages"in n&&d(e(0,m=n.messages))},n.$$.update=function(){16384&n.$$.dirty&&h(),98304&n.$$.dirty&&mn(),32&n.$$.dirty&&R(),524320&n.$$.dirty&&e(18,_=a&&!s),2244608&n.$$.dirty&&e(20,k=u&&(!r||r.id!==o)),1310848&n.$$.dirty&&e(6,x=(_||k)&&!f),49344&n.$$.dirty&&e(8,T=!x&&c&&(r||f)),16384&n.$$.dirty&&e(22,M=r&&r.isGroup||!1),4194304&n.$$.dirty&&(O=M?"messages_group_view":"message_view"),4120&n.$$.dirty&&(g&&y<P.MOBILE_DEVICE_MAX_WIDTH&&g<w&&(D(),sn(an.mark(function n(){return an.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,un();case 2:D();case 3:case"end":return n.stop()}},n)}))()),e(12,w=g))},[m,I,p,g,y,s,x,f,T,D,function(){I&&p.scrollTop+p.offsetHeight>p.scrollHeight-P.MIN_HIDE_MESSAGES_BOTTOM_DIST&&e(1,I=!1)},$,w,j,r,c,i,o,_,a,k,u,M,O,h,R,function(){e(3,g=window.innerHeight),e(4,y=window.innerWidth)},function(n){e(2,p=n)}]}export default(function(t){n(a,s);var e=Yn(a);function a(n){var t;return r(this,a),t=e.call(this),c(o(t),n,ut,at,i,{messages:0}),t}return a}());
